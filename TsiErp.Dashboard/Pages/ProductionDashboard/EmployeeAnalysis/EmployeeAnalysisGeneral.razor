@page "/employee-analysis-general"

@inject PersonelService PersonelService
<style>
    .GridZebra table tbody tr:nth-child(odd) {
        background-color: #B5B5B5;
    }

    .GridZebra table tbody tr:nth-child(n) {
        text-align: center;
    }

    table {
        font-family: arial, sans-serif;
        border-collapse: collapse;
        width: 80%;
        
    }

   /* td, th {
        border: 0px solid #dddddd;
        text-align: center;
        padding: 8px;
    }*/
    .DateTime {
        width: 400px;
    }

</style>

<ContentHeader>
</ContentHeader>
<Card>
    <Body>
        <table>
            <tr> 
                <td></td>
                <td>
                    <label>Başlangıç Tarihi:</label>
                    <DxDateEdit CssClass="DateTime" @bind-Date="@startDate"></DxDateEdit>
                </td>
                <td>
                    <label>Bitiş Tarihi:</label>
                    <DxDateEdit CssClass="DateTime" @bind-Date="@endDate"></DxDateEdit>
                </td>
                <td> 
                    <label></label>
                    <Button Size="ButtonSize.Medium" OnClick="@OnDateButtonClicked">Filtrele</Button>
                </td>
                <td></td>
            </tr>
        </table>

    </Body>

</Card>
<ContentMain>
    <Card>
        <Title><CardTitle><strong>Personel Analizi > Genel</strong></CardTitle></Title>
        <Body>
            <DxChart Data="@data" LabelOverlap="ChartLabelOverlap.Hide">
                <DxChartTitle Text="Hurda Adet Grafiği">
                </DxChartTitle>
                <DxChartValueAxis>
                    <DxChartAxisTitle Text="Hurda Adet" />
                </DxChartValueAxis>
                <DxChartValueAxis Name="Personel Adı">
                </DxChartValueAxis>
                <DxChartBarSeries Color="System.Drawing.Color.DarkRed"
                                  ArgumentField="@((EmployeeGeneralAnalysis i) => i.EmployeeName)"
                                  ValueField="@((EmployeeGeneralAnalysis i) => i.TotalScrap)"
                                  Name="Hurda Adet">
                    <DxChartSeriesLabel  Visible="true" BackgroundColor="System.Drawing.Color.DarkSlateGray" />
                </DxChartBarSeries>
                <DxChartLegend Orientation="Orientation.Horizontal"
                               HorizontalAlignment="HorizontalAlignment.Right"
                               Position="RelativePosition.Outside" />
            </DxChart>

        </Body>
    </Card>
    <Card>
        <Body>
            <DxGrid Data="@data"
                    CssClass="GridZebra"
                    ShowGroupPanel="true"
                    ShowFilterRow="true">
                <Columns>
                    <DxGridCommandColumn Width="120px" />
                    <DxGridDataColumn FieldName="EmployeeName"
                                      Caption="Personel Adı"
                                      SortOrder="GridColumnSortOrder.Descending"
                                      SortIndex="1" />
                    <DxGridDataColumn FieldName="OperationTime"
                                      Caption="Çalışma Süresi"
                                      Width="120px"
                                      SortOrder="GridColumnSortOrder.Descending"
                                      SortIndex="0"
                                      DisplayFormat="######" />
                    <DxGridDataColumn FieldName="HaltTime"
                                      Caption="Duruş Süresi "
                                      Width="120px"
                                      SortOrder="GridColumnSortOrder.Descending"
                                      SortIndex="0"
                                      DisplayFormat="######" />
                    <DxGridDataColumn FieldName="TotalProduction"
                                      Caption="Üretim Adet "
                                      SortOrder="GridColumnSortOrder.Descending"
                                      SortIndex="1"
                                      DisplayFormat="######" />
                    <DxGridDataColumn FieldName="TotalScrap"
                                      Caption="Hurda Adet"
                                      Width="120px"
                                      SortOrder="GridColumnSortOrder.Descending"
                                      SortIndex="0"
                                      DisplayFormat="######" />
                   
                </Columns>
            </DxGrid>
        </Body>
    </Card>
</ContentMain>


@code {
     List<EmployeeGeneralAnalysis> data = new List<EmployeeGeneralAnalysis>();
    DateTime startDate = DateTime.Today.AddDays(-60);
    DateTime endDate = DateTime.Today;
    DateTime date1 = new DateTime(2022, 06, 01);
    DateTime date2 = new DateTime(2022, 06, 03);

    protected override void OnInitialized()
    {
        data = PersonelService.GetEmployeeGeneralAnalysis(date1, date2);
    }

    void OnDateButtonClicked()
    {
        data = PersonelService.GetEmployeeGeneralAnalysis(startDate, endDate);
        StateHasChanged();
    }
   
    }
